@using Fluorite.MobileSite.Data
@{
    Layout = "~/Views/_AdminLayout.cshtml";
    ViewBag.Title = "添加文章";
    var seller = ViewBag.Seller as Seller;
}
<link href="~/Content/uploadify.css" rel="stylesheet" />
<script src="~/Content/jquery.uploadify.min.js"></script>

<ol class="breadcrumb">
    <li><a href="/gl">商家管理</a></li>
    <li><a href="/Admin/Articles?sellerId=@seller.Id">@seller.Name</a></li>
    <li class="active">添加文章</li>
</ol>
<form id="form_add_article" style="width: 60%; ">
    <div class="form-group">
        <label>文章入口位置</label>
        <select name="Type" class="form-control">
            <option value="@ArticleType.Carousel">轮播大图</option>
            <option value="@ArticleType.Common">页面中部</option>
            <option value="@ArticleType.Menu">左侧菜单</option>
            <option value="@ArticleType.SmallCover">页面底部小图</option>
        </select>
    </div>
    <div class="form-group">
        <label>文章标题</label>
        <input type="text" class="form-control" name="Name" placeholder="商户名称">
        <input type="hidden" name="ImageName" id="ImageName">
    </div>
    <div class="form-group">
        <label>封面图片</label><br/>
        <img id="cover" style="display: none"/><br/><br/>
        <input type="file" name="file_upload" id="file_upload"/>
    </div>
    <div class="form-group">
        <label>说明</label>
        <textarea class="form-control" rows="3" name="Remarks"></textarea>
    </div>
    <div class="form-group">
        <label>详情</label>
        <script id="container" name="content" type="text/plain">
        </script>
    </div>
    <input type="button" class="btn btn-primary" value="提交" onclick="submit()"/>
</form>

<!-- 配置文件 -->
<script src="~/UEditor/ueditor.config.js"></script>
<!-- 编辑器源码文件 -->
<script src="~/UEditor/ueditor.all.min.js"></script>
<!-- 实例化编辑器 -->
<script type="text/javascript">
    var ue = UE.getEditor('container', {
        toolbars: [
['fullscreen', 'source', 'undo', 'redo'],
['bold', 'italic', 'underline', 'fontborder', 'strikethrough', 'superscript', 'subscript', 'removeformat', 'formatmatch', 'autotypeset', 'blockquote', 'pasteplain', '|', 'forecolor', 'backcolor', 'insertorderedlist', 'insertunorderedlist', 'selectall', 'cleardoc', 'simpleupload']
        ],
        autoHeightEnabled: true,
        autoFloatEnabled: true
    });
    var article = { sellerId: '@seller.Id' };
    var submit = function () {
        article.details = ue.getContent();
        $.ajax({
            url: "@Url.Action("AddArticle", "Admin")",
            type: 'post',
            data: JSON.stringify(article),
            success: function () {
                alert('成功');
            },
            error: function () {
                alert('失败');
            }
        });
    };
    $('#file_upload').uploadify({
        'multi': false,
        'buttonText': '上传封面',
        'swf': '@Url.Content("~/Content/uploadify.swf")',
        'uploader': '@Url.Action("SaveImage")',
        'onUploadSuccess': function (file, data, response) {
            $('#cover').show().attr('src', '@Url.Content("~/temp/")' + data);
            $('#ImageName').val(data);
            $('.uploadify-button-text').html('更换封面？');
        }
    });
</script>